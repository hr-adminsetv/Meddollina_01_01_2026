@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 210 20% 98%;
    --foreground: 220 25% 10%;

    --card: 0 0% 100%;
    --card-foreground: 220 25% 10%;

    --popover: 0 0% 100%;
    --popover-foreground: 220 25% 10%;

    --primary: 11 85% 56%;
    --primary-foreground: 0 0% 100%;

    --secondary: 220 14% 96%;
    --secondary-foreground: 220 25% 10%;

    --muted: 220 14% 96%;
    --muted-foreground: 220 10% 46%;

    --accent: 11 75% 48%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    --border: 220 13% 91%;
    --input: 220 13% 91%;
    --ring: 11 85% 56%;

    --radius: 0.75rem;

    --sidebar-background: 220 25% 10%;
    --sidebar-foreground: 220 14% 96%;
    --sidebar-primary: 11 85% 56%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 20% 16%;
    --sidebar-accent-foreground: 220 14% 96%;
    --sidebar-border: 220 20% 18%;
    --sidebar-ring: 11 85% 56%;

    /* Custom medical theme colors */
    --medical-blue: 11 85% 56%;
    --medical-teal: 11 75% 48%;
    --medical-navy: 220 25% 10%;
    --medical-light: 210 20% 98%;
    --gradient-start: 11 85% 56%;
    --gradient-end: 11 75% 48%;
    
    /* Brand coral color for user messages */
    --brand-coral: 11 85% 56%;
    --brand-coral-hover: 11 85% 46%;
    --brand-coral-dark: 11 85% 38%;
  }

  .dark {
    --background: 220 25% 6%;
    --foreground: 220 14% 96%;

    --card: 220 25% 10%;
    --card-foreground: 220 14% 96%;

    --popover: 220 25% 10%;
    --popover-foreground: 220 14% 96%;

    --primary: 11 85% 56%;
    --primary-foreground: 0 0% 100%;

    --secondary: 220 20% 16%;
    --secondary-foreground: 220 14% 96%;

    --muted: 220 20% 16%;
    --muted-foreground: 220 10% 60%;

    --accent: 11 75% 48%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 62% 30%;
    --destructive-foreground: 0 0% 100%;

    --border: 220 20% 18%;
    --input: 220 20% 18%;
    --ring: 11 85% 56%;

    --sidebar-background: 220 25% 8%;
    --sidebar-foreground: 220 14% 96%;
    --sidebar-primary: 11 85% 56%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 20% 14%;
    --sidebar-accent-foreground: 220 14% 96%;
    --sidebar-border: 220 20% 14%;
    --sidebar-ring: 11 85% 56%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-family: 'Inter', system-ui, sans-serif;
    /* Only animate surfaces; animating text color can flicker on gradient/clip text */
    transition: background-color 0.3s ease;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: 'Space Grotesk', system-ui, sans-serif;
  }

  /* Smooth theme transitions for surface-like components only */
  .glass-effect,
  header,
  main,
  aside,
  section,
  footer,
  [data-surface] {
    transition: background-color 0.3s ease, border-color 0.3s ease;
  }
}

@layer utilities {
  .gradient-primary {
    background: linear-gradient(135deg, hsl(var(--gradient-start)) 0%, hsl(var(--gradient-end)) 100%);
  }

  .gradient-text {
    background: linear-gradient(135deg, hsl(var(--gradient-start)) 0%, hsl(var(--gradient-end)) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    /* Disable transitions to prevent flicker */
    transition: none !important;
  }

  .glass-effect {
    background: hsl(var(--card) / 0.8);
    backdrop-filter: blur(12px);
    border: 1px solid hsl(var(--border) / 0.5);
  }

  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
  }

  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb {
    background: hsl(var(--muted-foreground) / 0.3);
    border-radius: 3px;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--muted-foreground) / 0.5);
  }

  .animate-pulse-subtle {
    animation: pulse-subtle 2s ease-in-out infinite;
  }

  @keyframes pulse-subtle {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  .typing-indicator span {
    animation: typing 1.4s infinite;
    animation-fill-mode: both;
  }

  .typing-indicator span:nth-child(2) {
    animation-delay: 0.2s;
  }

  .typing-indicator span:nth-child(3) {
    animation-delay: 0.4s;
  }

  @keyframes typing {
    0% { opacity: 0.3; transform: translateY(0); }
    50% { opacity: 1; transform: translateY(-4px); }
    100% { opacity: 0.3; transform: translateY(0); }
  }

  /* Advanced AI thinking animation */
  @keyframes brain-pulse {
    0%, 100% { 
      transform: scale(1);
      filter: brightness(1);
    }
    50% { 
      transform: scale(1.1);
      filter: brightness(1.2);
    }
  }

  @keyframes orbit {
    0% { transform: rotate(0deg) translateX(20px) rotate(0deg); }
    100% { transform: rotate(360deg) translateX(20px) rotate(-360deg); }
  }

  @keyframes orbit-reverse {
    0% { transform: rotate(360deg) translateX(16px) rotate(-360deg); }
    100% { transform: rotate(0deg) translateX(16px) rotate(0deg); }
  }

  @keyframes wave {
    0%, 100% { height: 8px; }
    50% { height: 24px; }
  }

  @keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
  }

  @keyframes float {
    0%, 100% { transform: translateY(0) scale(1); opacity: 0.6; }
    50% { transform: translateY(-8px) scale(1.1); opacity: 1; }
  }

  .ai-thinking-brain {
    animation: brain-pulse 1.5s ease-in-out infinite;
  }

  .ai-orbit-dot {
    animation: orbit 2s linear infinite;
  }

  .ai-orbit-dot-reverse {
    animation: orbit-reverse 2.5s linear infinite;
  }

  .ai-wave-bar {
    animation: wave 1s ease-in-out infinite;
  }

  .ai-wave-bar:nth-child(1) { animation-delay: 0s; }
  .ai-wave-bar:nth-child(2) { animation-delay: 0.1s; }
  .ai-wave-bar:nth-child(3) { animation-delay: 0.2s; }
  .ai-wave-bar:nth-child(4) { animation-delay: 0.3s; }
  .ai-wave-bar:nth-child(5) { animation-delay: 0.4s; }

  .ai-shimmer {
    background: linear-gradient(
      90deg,
      hsl(var(--primary) / 0.1) 0%,
      hsl(var(--primary) / 0.4) 50%,
      hsl(var(--primary) / 0.1) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 2s ease-in-out infinite;
  }

  .ai-shimmer-coral {
    background: linear-gradient(
      90deg,
      hsl(var(--brand-coral) / 0.1) 0%,
      hsl(var(--brand-coral) / 0.6) 50%,
      hsl(var(--brand-coral) / 0.1) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 2s ease-in-out infinite;
  }

  .ai-float-particle {
    animation: float 2s ease-in-out infinite;
  }

  .ai-float-particle:nth-child(1) { animation-delay: 0s; }
  .ai-float-particle:nth-child(2) { animation-delay: 0.3s; }
  .ai-float-particle:nth-child(3) { animation-delay: 0.6s; }
}

/* ============================================
   Chat Component Styles
============================================ */

@layer components {
  /* Chat Input Styles */
  .chat-input-container {
    @apply border-t border-border bg-background/80 backdrop-blur-sm;
  }

  .chat-input-wrapper {
    @apply relative flex items-end gap-2 sm:gap-3 p-3 rounded-2xl border border-border bg-card shadow-sm;
    @apply focus-within:ring-2 focus-within:ring-primary/20 focus-within:border-primary/50 transition-all;
  }

  .chat-input-icon-btn {
    @apply h-8 w-8 sm:h-9 sm:w-9 text-muted-foreground hover:text-foreground;
  }

  .chat-textarea {
    @apply flex-1 resize-none bg-transparent border-0 text-foreground;
    @apply placeholder:text-muted-foreground py-2.5 max-h-[200px] scrollbar-thin text-sm sm:text-base;
    @apply focus:outline-none focus:ring-0;
  }

  .chat-send-btn {
    @apply h-8 w-8 sm:h-9 sm:w-9 rounded-lg transition-all;
  }

  .chat-send-btn-active {
    @apply gradient-primary text-white;
  }

  .chat-send-btn-inactive {
    @apply bg-muted text-muted-foreground;
  }

  .chat-attached-file {
    @apply relative flex items-center gap-2 px-3 py-2 bg-muted rounded-lg border border-border;
  }

  .chat-file-remove-btn {
    @apply ml-1 p-1 rounded-full text-muted-foreground;
    @apply hover:bg-destructive/20 hover:text-destructive transition-colors;
  }

  .chat-dropdown-content {
    @apply bg-card border border-border shadow-lg z-50;
  }

  /* Chat Message Styles */
  .chat-avatar {
    @apply w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 overflow-hidden transition-all duration-300;
  }

  .chat-avatar-assistant {
    /* No background - logo provides visual */
  }

  .chat-avatar-user {
    background-color: hsl(var(--brand-coral));
  }

  .chat-bubble {
    @apply rounded-2xl px-4 py-3;
  }

  .chat-bubble-assistant {
    @apply bg-muted/50 rounded-tl-sm;
  }

  .chat-bubble-user {
    @apply rounded-tr-sm text-white;
    background-color: hsl(var(--brand-coral));
  }

  .chat-message-actions {
    @apply flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity;
  }

  .chat-action-btn {
    @apply h-7 w-7 text-muted-foreground hover:text-foreground transition-colors;
  }

  .chat-feedback-panel {
    @apply animate-in fade-in slide-in-from-top-2 duration-200;
    @apply p-3 rounded-xl border border-border bg-card shadow-lg max-w-sm;
  }

  .chat-feedback-textarea {
    @apply w-full min-h-[80px] p-2 text-sm bg-background border border-border rounded-lg resize-none;
    @apply focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary/50;
  }

  /* Scroll Button */
  .chat-scroll-btn {
    @apply fixed bottom-32 right-8 z-50 rounded-full shadow-lg;
    @apply bg-primary hover:bg-primary/90 animate-in fade-in zoom-in duration-200;
  }

  .chat-unread-badge {
    @apply absolute -top-1 -right-1 min-w-5 h-5 px-1.5;
    @apply flex items-center justify-center text-xs font-medium;
    @apply bg-destructive text-destructive-foreground rounded-full;
  }

  /* AI Thinking Animation Styles */
  .ai-thinking-container {
    @apply flex items-center gap-4 py-2;
  }

  .ai-thinking-orb-container {
    @apply relative w-14 h-14 flex items-center justify-center;
    perspective: 200px;
  }

  .ai-thinking-glow-outer {
    @apply absolute rounded-full transition-all duration-700 ease-in-out;
    inset: -8px;
  }

  .ai-thinking-glow-visible {
    @apply opacity-100 blur-xl;
    background: linear-gradient(to right, 
      hsl(187 85% 53% / 0.3), 
      hsl(280 85% 53% / 0.3), 
      hsl(330 85% 53% / 0.3)
    );
    animation: glow-pulse 3s ease-in-out infinite;
  }

  .ai-thinking-glow-inner {
    @apply absolute rounded-full transition-all duration-700 ease-in-out;
    inset: -4px;
  }

  .ai-thinking-glow-inner-visible {
    @apply opacity-80 blur-lg;
    background: linear-gradient(to bottom right,
      hsl(160 85% 53% / 0.2),
      hsl(187 85% 53% / 0.2),
      hsl(280 85% 53% / 0.2)
    );
    animation: spin 8s linear infinite reverse;
  }

  .ai-thinking-logo {
    @apply absolute inset-0 flex items-center justify-center transition-all duration-700 ease-in-out;
  }

  .ai-thinking-logo-visible {
    @apply opacity-100 scale-100 rotate-0;
  }

  .ai-thinking-logo-hidden {
    @apply opacity-0 scale-0 rotate-180;
  }

  .ai-thinking-gyroscope {
    @apply absolute inset-0 flex items-center justify-center transition-all duration-700 ease-in-out;
    transform-style: preserve-3d;
  }

  .ai-thinking-gyroscope-visible {
    @apply opacity-100 scale-100;
    animation: gyro-rotate 8s ease-in-out infinite;
  }

  .ai-thinking-gyroscope-hidden {
    @apply opacity-0 scale-0;
  }

  .ai-thinking-core {
    @apply absolute w-7 h-7 rounded-full flex items-center justify-center;
    background: linear-gradient(to bottom right, 
      hsl(187 85% 53%), 
      hsl(280 85% 53%), 
      hsl(330 85% 53%)
    );
    box-shadow: 
      0 0 20px hsl(280 85% 53% / 0.8),
      0 0 40px hsl(187 85% 53% / 0.4);
    transform: translateZ(0px);
  }

  /* Orbital Rings */
  .ai-orbit-ring {
    @apply absolute rounded-full;
    transform-style: preserve-3d;
  }

  .ai-orbit-ring-1 {
    @apply w-10 h-10 border-2;
    border-color: hsl(187 85% 53%);
    box-shadow: 
      0 0 15px hsl(187 85% 53% / 0.7),
      inset 0 0 10px hsl(187 85% 53% / 0.3);
    animation: spin 1.2s linear infinite;
    transform: rotateX(75deg);
  }

  .ai-orbit-ring-2 {
    @apply w-10 h-10 border-2;
    border-color: hsl(280 85% 53%);
    box-shadow: 
      0 0 15px hsl(280 85% 53% / 0.7),
      inset 0 0 10px hsl(280 85% 53% / 0.3);
    animation: spin 1.8s linear infinite reverse;
    transform: rotateY(75deg);
  }

  .ai-orbit-ring-3 {
    @apply w-10 h-10 border-2;
    border-color: hsl(330 85% 53%);
    box-shadow: 
      0 0 15px hsl(330 85% 53% / 0.7),
      inset 0 0 10px hsl(330 85% 53% / 0.3);
    animation: spin 1.5s linear infinite;
    transform: rotateX(45deg) rotateY(45deg);
  }

  .ai-orbit-ring-4 {
    @apply w-12 h-12 border;
    border-color: hsl(160 85% 53%);
    box-shadow: 0 0 12px hsl(160 85% 53% / 0.6);
    animation: spin 2.2s linear infinite reverse;
    transform: rotateX(60deg) rotateZ(30deg);
  }

  .ai-orbit-ring-5 {
    @apply w-6 h-6 border;
    border-color: hsl(45 85% 53% / 0.8);
    box-shadow: 0 0 10px hsl(45 85% 53% / 0.5);
    animation: spin 0.8s linear infinite;
    transform: rotateY(80deg) rotateZ(20deg);
  }

  .ai-orbit-ring-6 {
    @apply border;
    width: 52px;
    height: 52px;
    border-color: hsl(220 85% 60% / 0.6);
    box-shadow: 0 0 10px hsl(220 85% 60% / 0.4);
    animation: spin 3s linear infinite;
    transform: rotateX(30deg) rotateY(60deg);
  }

  .ai-orbit-ring-7 {
    @apply w-9 h-9 border;
    border-color: hsl(350 85% 65% / 0.7);
    box-shadow: 0 0 12px hsl(350 85% 65% / 0.5);
    animation: spin 1.6s linear infinite reverse;
    transform: rotateX(-60deg) rotateZ(45deg);
  }

  .ai-orbit-ring-8 {
    @apply w-8 h-8 border;
    border-color: hsl(240 80% 65% / 0.6);
    box-shadow: 0 0 8px hsl(240 80% 65% / 0.4);
    animation: spin 0.9s linear infinite;
    transform: rotateY(-70deg) rotateX(25deg);
  }

  /* Particles */
  .ai-particle {
    @apply absolute rounded-full;
    animation: particle-float 3s ease-in-out infinite;
  }

  .ai-particle-1 {
    @apply w-2 h-2;
    background-color: hsl(187 85% 53%);
    box-shadow: 0 0 8px hsl(187 85% 53% / 0.9);
    transform: translateZ(20px) translateY(-20px);
  }

  .ai-particle-2 {
    @apply w-2 h-2;
    background-color: hsl(280 85% 53%);
    box-shadow: 0 0 8px hsl(280 85% 53% / 0.9);
    animation-delay: 0.5s;
    transform: translateZ(-15px) translateY(18px);
  }

  .ai-particle-3 {
    @apply w-1.5 h-1.5;
    background-color: hsl(330 85% 53%);
    box-shadow: 0 0 6px hsl(330 85% 53% / 0.9);
    animation-delay: 0.3s;
    transform: translateX(-18px) translateZ(10px);
  }

  .ai-particle-4 {
    @apply w-1.5 h-1.5;
    background-color: hsl(160 85% 53%);
    box-shadow: 0 0 6px hsl(160 85% 53% / 0.9);
    animation-delay: 0.7s;
    transform: translateX(18px) translateZ(-8px);
  }

  .ai-particle-5 {
    @apply w-1 h-1;
    background-color: hsl(45 85% 53%);
    box-shadow: 0 0 5px hsl(45 85% 53% / 0.8);
    animation-delay: 0.2s;
    transform: translateZ(12px) translateX(12px) translateY(-10px);
  }

  .ai-particle-6 {
    @apply w-1 h-1;
    background-color: hsl(220 85% 60%);
    box-shadow: 0 0 5px hsl(220 85% 60% / 0.8);
    animation-delay: 0.4s;
    transform: translateZ(-10px) translateX(-10px) translateY(12px);
  }

  /* Text Animation */
  .ai-thinking-text {
    @apply text-sm text-foreground block transition-all duration-300 ease-out;
  }

  .ai-thinking-text-enter {
    @apply translate-y-0 opacity-100;
  }

  .ai-thinking-text-exit {
    @apply -translate-y-full opacity-0;
  }
}

/* AI Thinking Keyframes */
@keyframes gyro-rotate {
  0% { transform: rotateX(0deg) rotateY(0deg); }
  25% { transform: rotateX(15deg) rotateY(90deg); }
  50% { transform: rotateX(-10deg) rotateY(180deg); }
  75% { transform: rotateX(10deg) rotateY(270deg); }
  100% { transform: rotateX(0deg) rotateY(360deg); }
}

@keyframes glow-pulse {
  0%, 100% { opacity: 0.6; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.05); }
}

@keyframes particle-float {
  0%, 100% { opacity: 0.7; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.3); }
}
